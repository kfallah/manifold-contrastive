defaults:
  - exp_cfg
  - default_hydra
  - dataloader/tinyimagenet@train_dataloader_cfg
  - dataloader/tinyimagenet@eval_dataloader_cfg
  - _self_

exp_dir: results
devices: [0]
enable_wandb: true
seed: 0

model_cfg:
  backbone_cfg:
    hub_model_name: torchhub:resnet18
  loss_cfg:
    ntxent_loss_active: true
    ntxent_temp: 0.5

trainer_cfg:
  num_epochs: 1000
  use_amp: false
  optimizer_cfg:
    optimizer: SGD
    initial_lr: 0.6
    weight_decay: 1e-6
    enable_nesterov: true
  scheduler_cfg:
    scheduler: LinearWarmupCosineAnnealingLR
    warmup_epochs: 10
  metric_logger_cfg:
    enable_wandb_logging: true
    enable_console_logging: true
    enable_local_figure_saving: true
    loss_log_freq: 500
    enable_optimizer_logging: true
    optimizer_log_freq: 500
    enable_collapse_logging: true
    collapse_log_freq: 2000
    transop_log_freq: 5000
    enable_tsne_plot: true
    tsne_plot_freq: 10000
    enable_log_spectra_plot: true
    log_spectra_plot_freq: 10000

evaluator_cfg:
  knn_eval_cfg:
    enable_runner: false
  clustering_eval_cfg:
    enable_runner: false
  linear_probe_eval_cfg:
    use_for_best_checkpoint: true
    enable_runner: true
    eval_freq: 100
    num_epochs: 100
    use_amp: true
eval_dataloader_cfg:
  collate_fn_cfg:
    collate_fn_type: NONE
  train: false
  shuffle: false
  batch_size: 512