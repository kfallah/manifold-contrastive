defaults:
  - transop_cifar10_simclr_laplacian
  - _self_

exp_name: ft_vi_20s

trainer_cfg:
  optimizer_cfg:
    initial_lr: 0.3
  num_epochs: 1000
model_cfg:
  backbone_cfg:
    load_backbone: /home/kion/manifold-contrastive/model_zoo/transop_40dict_vi_simclr.pt
    freeze_backbone: false
  loss_cfg:
    ntxent_loss_active: true
    ntxent_loss_weight: 1.0
    kl_weight_warmup: Exponential
    kl_loss_weight: 1.0e-5
    kl_detach_shift: true
    enable_shift_l2: true
    transop_loss_active: true
    transop_loss_weight: 0.1
  header_cfg:
    transop_header_cfg:
      transop_lr: 0.3
      transop_weight_decay: 5.0e-7
      start_iter: 0
      fine_tune_iter: 0
      vi_cfg:
        max_sample_start_iter: 0
        variational_encoder_lr: 0.01
        enable_thresh_warmup: false
        enable_max_sampling: true
        shift_prior: 0.05

evaluator_cfg:
  knn_eval_cfg:
    enable_runner: true
  clustering_eval_cfg:
    enable_runner: true
  linear_probe_eval_cfg:
    enable_runner: true